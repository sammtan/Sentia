<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 14.1.2 (20260124.0452)
 -->
<!-- Title: Sentium Pages: 1 -->
<svg width="1456pt" height="2442pt"
 viewBox="0.00 0.00 1456.00 2442.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2438.45)">
<title>Sentium</title>
<polygon fill="white" stroke="none" points="-4,4 -4,-2438.45 1451.92,-2438.45 1451.92,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_geom</title>
<path fill="#fff8e1" stroke="#f9a825" stroke-width="1.8" d="M1079.92,-2011.2C1079.92,-2011.2 1427.92,-2011.2 1427.92,-2011.2 1433.92,-2011.2 1439.92,-2017.2 1439.92,-2023.2 1439.92,-2023.2 1439.92,-2293.4 1439.92,-2293.4 1439.92,-2299.4 1433.92,-2305.4 1427.92,-2305.4 1427.92,-2305.4 1079.92,-2305.4 1079.92,-2305.4 1073.92,-2305.4 1067.92,-2299.4 1067.92,-2293.4 1067.92,-2293.4 1067.92,-2023.2 1067.92,-2023.2 1067.92,-2017.2 1073.92,-2011.2 1079.92,-2011.2"/>
<text xml:space="preserve" text-anchor="middle" x="1253.92" y="-2290" font-family="Inter" font-size="12.00" fill="#f57f17">‚ë† Geometric Memory Manifold</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer</title>
<path fill="#f3f4fe" stroke="#3949ab" stroke-width="1.8" d="M761.92,-335.05C761.92,-335.05 1223.92,-335.05 1223.92,-335.05 1229.92,-335.05 1235.92,-341.05 1235.92,-347.05 1235.92,-347.05 1235.92,-1963.95 1235.92,-1963.95 1235.92,-1969.95 1229.92,-1975.95 1223.92,-1975.95 1223.92,-1975.95 761.92,-1975.95 761.92,-1975.95 755.92,-1975.95 749.92,-1969.95 749.92,-1963.95 749.92,-1963.95 749.92,-347.05 749.92,-347.05 749.92,-341.05 755.92,-335.05 761.92,-335.05"/>
<text xml:space="preserve" text-anchor="middle" x="992.92" y="-1960.55" font-family="Inter" font-size="12.00" fill="#1a237e">SentiumLayer &#160;√óL &#160;(pre&#45;norm, residual)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_attn</title>
<path fill="#e8eaf6" stroke="#5c6bc0" stroke-width="1.8" d="M875.92,-1419.69C875.92,-1419.69 1097.92,-1419.69 1097.92,-1419.69 1103.92,-1419.69 1109.92,-1425.69 1109.92,-1431.69 1109.92,-1431.69 1109.92,-1859.44 1109.92,-1859.44 1109.92,-1865.44 1103.92,-1871.44 1097.92,-1871.44 1097.92,-1871.44 875.92,-1871.44 875.92,-1871.44 869.92,-1871.44 863.92,-1865.44 863.92,-1859.44 863.92,-1859.44 863.92,-1431.69 863.92,-1431.69 863.92,-1425.69 869.92,-1419.69 875.92,-1419.69"/>
<text xml:space="preserve" text-anchor="middle" x="986.92" y="-1856.99" font-family="Inter" font-size="11.00" fill="#283593">‚ë° Integral Operator Attention</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_moe</title>
<path fill="#fce4ec" stroke="#c62828" stroke-width="1.8" d="M769.92,-711.01C769.92,-711.01 1139.92,-711.01 1139.92,-711.01 1145.92,-711.01 1151.92,-717.01 1151.92,-723.01 1151.92,-723.01 1151.92,-1137.51 1151.92,-1137.51 1151.92,-1143.51 1145.92,-1149.51 1139.92,-1149.51 1139.92,-1149.51 769.92,-1149.51 769.92,-1149.51 763.92,-1149.51 757.92,-1143.51 757.92,-1137.51 757.92,-1137.51 757.92,-723.01 757.92,-723.01 757.92,-717.01 763.92,-711.01 769.92,-711.01"/>
<text xml:space="preserve" text-anchor="middle" x="954.92" y="-1135.06" font-family="Inter" font-size="11.00" fill="#b71c1c">‚ë¢ OT&#45;MoE &#160;(Optimal Transport Routing)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_sde</title>
<path fill="#e8f5e9" stroke="#2e7d32" stroke-width="1.8" d="M769.92,-343.05C769.92,-343.05 1006.92,-343.05 1006.92,-343.05 1012.92,-343.05 1018.92,-349.05 1018.92,-355.05 1018.92,-355.05 1018.92,-518.35 1018.92,-518.35 1018.92,-524.35 1012.92,-530.35 1006.92,-530.35 1006.92,-530.35 769.92,-530.35 769.92,-530.35 763.92,-530.35 757.92,-524.35 757.92,-518.35 757.92,-518.35 757.92,-355.05 757.92,-355.05 757.92,-349.05 763.92,-343.05 769.92,-343.05"/>
<text xml:space="preserve" text-anchor="middle" x="888.42" y="-515.9" font-family="Inter" font-size="11.00" fill="#1b5e20">‚ë£ Adaptive Stochastic Depth &#160;(SDE DropPath)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_train</title>
<path fill="#f9fbe7" stroke="#558b2f" d="M513.92,-145C513.92,-145 1371.92,-145 1371.92,-145 1377.92,-145 1383.92,-151 1383.92,-157 1383.92,-157 1383.92,-214.15 1383.92,-214.15 1383.92,-220.15 1377.92,-226.15 1371.92,-226.15 1371.92,-226.15 513.92,-226.15 513.92,-226.15 507.92,-226.15 501.92,-220.15 501.92,-214.15 501.92,-214.15 501.92,-157 501.92,-157 501.92,-151 507.92,-145 513.92,-145"/>
<text xml:space="preserve" text-anchor="middle" x="942.92" y="-211.7" font-family="Inter" font-size="11.00" fill="#33691e">‚ë§ Hardware&#45;Co&#45;Designed Execution</text>
</g>
<!-- INPUT -->
<g id="node1" class="node">
<title>INPUT</title>
<path fill="#e8f5e9" stroke="#388e3c" stroke-width="1.4" d="M1359.55,-2434.45C1359.55,-2434.45 1194.84,-2434.45 1194.84,-2434.45 1188.84,-2434.45 1179.88,-2429.23 1176.93,-2424.01 1176.93,-2424.01 1140.2,-2359.1 1140.2,-2359.1 1137.25,-2353.88 1140.29,-2348.65 1146.29,-2348.65 1146.29,-2348.65 1311,-2348.65 1311,-2348.65 1317,-2348.65 1325.96,-2353.88 1328.91,-2359.1 1328.91,-2359.1 1365.64,-2424.01 1365.64,-2424.01 1368.59,-2429.23 1365.55,-2434.45 1359.55,-2434.45"/>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2395.35" font-family="Inter" font-size="11.00">Token Sequence</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2381.1" font-family="Inter" font-size="11.00"> x = (x‚ÇÅ ‚Ä¶ x‚Çô)</text>
</g>
<!-- EMBED_E -->
<g id="node2" class="node">
<title>EMBED_E</title>
<path fill="#fff9c4" stroke="#f9a825" stroke-width="1.4" d="M1149.88,-2267.28C1149.88,-2267.28 1087.96,-2267.28 1087.96,-2267.28 1081.96,-2267.28 1075.96,-2261.28 1075.96,-2255.28 1075.96,-2255.28 1075.96,-2222.13 1075.96,-2222.13 1075.96,-2216.13 1081.96,-2210.13 1087.96,-2210.13 1087.96,-2210.13 1149.88,-2210.13 1149.88,-2210.13 1155.88,-2210.13 1161.88,-2216.13 1161.88,-2222.13 1161.88,-2222.13 1161.88,-2255.28 1161.88,-2255.28 1161.88,-2261.28 1155.88,-2267.28 1149.88,-2267.28"/>
<text xml:space="preserve" text-anchor="middle" x="1118.92" y="-2249.63" font-family="Inter" font-size="11.00">Euclidean</text>
<text xml:space="preserve" text-anchor="middle" x="1118.92" y="-2235.38" font-family="Inter" font-size="11.00">Embedding</text>
<text xml:space="preserve" text-anchor="middle" x="1118.92" y="-2221.13" font-family="Inter" font-size="11.00"> ‚Ñù^{d_e}</text>
</g>
<!-- INPUT&#45;&gt;EMBED_E -->
<g id="edge1" class="edge">
<title>INPUT&#45;&gt;EMBED_E</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1215.24,-2348.13C1194.38,-2324.66 1168.81,-2295.86 1149.25,-2273.85"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1151.34,-2272.51 1144.86,-2268.9 1147.67,-2275.76 1151.34,-2272.51"/>
</g>
<!-- EMBED_H -->
<g id="node3" class="node">
<title>EMBED_H</title>
<path fill="#fff9c4" stroke="#f9a825" stroke-width="1.4" d="M1291.76,-2274.4C1291.76,-2274.4 1214.09,-2274.4 1214.09,-2274.4 1208.09,-2274.4 1202.09,-2268.4 1202.09,-2262.4 1202.09,-2262.4 1202.09,-2215 1202.09,-2215 1202.09,-2209 1208.09,-2203 1214.09,-2203 1214.09,-2203 1291.76,-2203 1291.76,-2203 1297.76,-2203 1303.76,-2209 1303.76,-2215 1303.76,-2215 1303.76,-2262.4 1303.76,-2262.4 1303.76,-2268.4 1297.76,-2274.4 1291.76,-2274.4"/>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2256.75" font-family="Inter" font-size="11.00">Hyperbolic</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2242.5" font-family="Inter" font-size="11.00">Embedding</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2228.25" font-family="Inter" font-size="11.00"> ùîπ^{d_h}</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2214" font-family="Inter" font-size="11.00">(Poincar√© ball)</text>
</g>
<!-- INPUT&#45;&gt;EMBED_H -->
<g id="edge2" class="edge">
<title>INPUT&#45;&gt;EMBED_H</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1252.92,-2348.13C1252.92,-2327.94 1252.92,-2303.82 1252.92,-2283.46"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1255.37,-2283.51 1252.92,-2276.51 1250.47,-2283.51 1255.37,-2283.51"/>
<text xml:space="preserve" text-anchor="middle" x="1273.17" y="-2316.1" font-family="Inter" font-size="9.00"> Phase 1+</text>
</g>
<!-- EMBED_G -->
<g id="node4" class="node">
<title>EMBED_G</title>
<path fill="#fff9c4" stroke="#f9a825" stroke-width="1.4" d="M1419.63,-2274.4C1419.63,-2274.4 1356.21,-2274.4 1356.21,-2274.4 1350.21,-2274.4 1344.21,-2268.4 1344.21,-2262.4 1344.21,-2262.4 1344.21,-2215 1344.21,-2215 1344.21,-2209 1350.21,-2203 1356.21,-2203 1356.21,-2203 1419.63,-2203 1419.63,-2203 1425.63,-2203 1431.63,-2209 1431.63,-2215 1431.63,-2215 1431.63,-2262.4 1431.63,-2262.4 1431.63,-2268.4 1425.63,-2274.4 1419.63,-2274.4"/>
<text xml:space="preserve" text-anchor="middle" x="1387.92" y="-2256.75" font-family="Inter" font-size="11.00">Graph</text>
<text xml:space="preserve" text-anchor="middle" x="1387.92" y="-2242.5" font-family="Inter" font-size="11.00">Embedding</text>
<text xml:space="preserve" text-anchor="middle" x="1387.92" y="-2228.25" font-family="Inter" font-size="11.00"> ùí¢</text>
<text xml:space="preserve" text-anchor="middle" x="1387.92" y="-2214" font-family="Inter" font-size="11.00">(GNN layer)</text>
</g>
<!-- INPUT&#45;&gt;EMBED_G -->
<g id="edge3" class="edge">
<title>INPUT&#45;&gt;EMBED_G</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1290.88,-2348.13C1309.68,-2327.13 1332.29,-2301.86 1350.95,-2281.01"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1352.56,-2282.89 1355.4,-2276.04 1348.91,-2279.63 1352.56,-2282.89"/>
<text xml:space="preserve" text-anchor="middle" x="1340.67" y="-2316.1" font-family="Inter" font-size="9.00"> Phase 1+</text>
</g>
<!-- GEOM_FUSE -->
<g id="node5" class="node">
<title>GEOM_FUSE</title>
<path fill="#ffe082" stroke="#f9a825" stroke-width="1.4" d="M1348.92,-2154C1348.92,-2154 1156.92,-2154 1156.92,-2154 1150.92,-2154 1144.92,-2148 1144.92,-2142 1144.92,-2142 1144.92,-2123.1 1144.92,-2123.1 1144.92,-2117.1 1150.92,-2111.1 1156.92,-2111.1 1156.92,-2111.1 1348.92,-2111.1 1348.92,-2111.1 1354.92,-2111.1 1360.92,-2117.1 1360.92,-2123.1 1360.92,-2123.1 1360.92,-2142 1360.92,-2142 1360.92,-2148 1354.92,-2154 1348.92,-2154"/>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2136.35" font-family="Inter" font-size="11.00">Manifold Fusion</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2122.1" font-family="Inter" font-size="11.00"> h = W‚ÇÅh_E + W‚ÇÇh_H + W‚ÇÉh_G</text>
</g>
<!-- EMBED_E&#45;&gt;GEOM_FUSE -->
<g id="edge4" class="edge">
<title>EMBED_E&#45;&gt;GEOM_FUSE</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1155.18,-2209.52C1175.06,-2194.07 1199.55,-2175.03 1219.05,-2159.88"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1220.53,-2161.83 1224.55,-2155.6 1217.52,-2157.97 1220.53,-2161.83"/>
</g>
<!-- EMBED_H&#45;&gt;GEOM_FUSE -->
<g id="edge5" class="edge">
<title>EMBED_H&#45;&gt;GEOM_FUSE</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1252.92,-2202.44C1252.92,-2189.62 1252.92,-2175.28 1252.92,-2163.01"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1255.37,-2163.31 1252.92,-2156.31 1250.47,-2163.31 1255.37,-2163.31"/>
</g>
<!-- EMBED_G&#45;&gt;GEOM_FUSE -->
<g id="edge6" class="edge">
<title>EMBED_G&#45;&gt;GEOM_FUSE</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1343.72,-2203.6C1325.25,-2189.36 1304.13,-2173.07 1286.92,-2159.78"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1288.76,-2158.11 1281.72,-2155.77 1285.76,-2161.99 1288.76,-2158.11"/>
</g>
<!-- ROPE -->
<g id="node6" class="node">
<title>ROPE</title>
<path fill="#ffe082" stroke="#f9a825" stroke-width="1.4" d="M1323.63,-2062.1C1323.63,-2062.1 1182.21,-2062.1 1182.21,-2062.1 1176.21,-2062.1 1170.21,-2056.1 1170.21,-2050.1 1170.21,-2050.1 1170.21,-2031.2 1170.21,-2031.2 1170.21,-2025.2 1176.21,-2019.2 1182.21,-2019.2 1182.21,-2019.2 1323.63,-2019.2 1323.63,-2019.2 1329.63,-2019.2 1335.63,-2025.2 1335.63,-2031.2 1335.63,-2031.2 1335.63,-2050.1 1335.63,-2050.1 1335.63,-2056.1 1329.63,-2062.1 1323.63,-2062.1"/>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2044.45" font-family="Inter" font-size="11.00">RoPE</text>
<text xml:space="preserve" text-anchor="middle" x="1252.92" y="-2030.2" font-family="Inter" font-size="11.00">(Rotary Position Encoding)</text>
</g>
<!-- GEOM_FUSE&#45;&gt;ROPE -->
<g id="edge7" class="edge">
<title>GEOM_FUSE&#45;&gt;ROPE</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1252.92,-2110.7C1252.92,-2098.99 1252.92,-2084.17 1252.92,-2071.27"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1255.37,-2071.52 1252.92,-2064.52 1250.47,-2071.52 1255.37,-2071.52"/>
</g>
<!-- RMSNORM1 -->
<g id="node7" class="node">
<title>RMSNORM1</title>
<ellipse fill="#c5cae9" stroke="#3949ab" stroke-width="1.4" cx="1157.92" cy="-1924.7" rx="55.45" ry="20.26"/>
<text xml:space="preserve" text-anchor="middle" x="1157.92" y="-1921.37" font-family="Inter" font-size="11.00">RMSNorm</text>
</g>
<!-- ROPE&#45;&gt;RMSNORM1 -->
<g id="edge8" class="edge">
<title>ROPE&#45;&gt;RMSNORM1</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1235.5,-2018.75C1219.61,-1999.7 1196.11,-1971.51 1179.14,-1951.15"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1181.18,-1949.78 1174.82,-1945.97 1177.42,-1952.91 1181.18,-1949.78"/>
<text xml:space="preserve" text-anchor="middle" x="1222.93" y="-1986.65" font-family="Inter" font-size="9.00"> H‚ÅΩ‚Å∞‚Åæ</text>
</g>
<!-- HW4 -->
<g id="node29" class="node">
<title>HW4</title>
<polygon fill="#f0f4c3" stroke="#558b2f" stroke-width="1.4" points="1369.63,-195.9 1246.21,-195.9 1246.21,-153 1375.63,-153 1375.63,-189.9 1369.63,-195.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1369.63,-195.9 1369.63,-189.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1375.63,-189.9 1369.63,-189.9"/>
<text xml:space="preserve" text-anchor="middle" x="1310.92" y="-178.25" font-family="Inter" font-size="11.00">Context Curriculum</text>
<text xml:space="preserve" text-anchor="middle" x="1310.92" y="-164" font-family="Inter" font-size="11.00">128 ‚Üí 4096 tokens</text>
</g>
<!-- ROPE&#45;&gt;HW4 -->
<!-- QKV -->
<g id="node8" class="node">
<title>QKV</title>
<path fill="#c5cae9" stroke="#5c6bc0" stroke-width="1.4" d="M1054.51,-1841.19C1054.51,-1841.19 993.34,-1841.19 993.34,-1841.19 987.34,-1841.19 981.34,-1835.19 981.34,-1829.19 981.34,-1829.19 981.34,-1796.04 981.34,-1796.04 981.34,-1790.04 987.34,-1784.04 993.34,-1784.04 993.34,-1784.04 1054.51,-1784.04 1054.51,-1784.04 1060.51,-1784.04 1066.51,-1790.04 1066.51,-1796.04 1066.51,-1796.04 1066.51,-1829.19 1066.51,-1829.19 1066.51,-1835.19 1060.51,-1841.19 1054.51,-1841.19"/>
<text xml:space="preserve" text-anchor="middle" x="1023.92" y="-1823.54" font-family="Inter" font-size="11.00">Q / K / V</text>
<text xml:space="preserve" text-anchor="middle" x="1023.92" y="-1809.29" font-family="Inter" font-size="11.00">Projections</text>
<text xml:space="preserve" text-anchor="middle" x="1023.92" y="-1795.04" font-family="Inter" font-size="11.00">(GQA)</text>
</g>
<!-- RMSNORM1&#45;&gt;QKV -->
<g id="edge9" class="edge">
<title>RMSNORM1&#45;&gt;QKV</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1129.91,-1906.87C1104.48,-1891.6 1070.92,-1871.44 1070.92,-1871.44 1070.92,-1871.44 1062.29,-1860.82 1052.43,-1848.69"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1054.33,-1847.14 1048.01,-1843.26 1050.53,-1850.23 1054.33,-1847.14"/>
</g>
<!-- RESID1 -->
<g id="node13" class="node">
<title>RESID1</title>
<ellipse fill="#ffffff" stroke="#3949ab" stroke-width="1.4" cx="1064.92" cy="-1325.36" rx="53.33" ry="53.33"/>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-1327.66" font-family="Inter" font-size="11.00">Ôºã</text>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-1316.41" font-family="Inter" font-size="11.00">(residual)</text>
</g>
<!-- RMSNORM1&#45;&gt;RESID1 -->
<g id="edge16" class="edge">
<title>RMSNORM1&#45;&gt;RESID1</title>
<path fill="none" stroke="#888888" stroke-width="1.2" stroke-dasharray="1,5" d="M1157.92,-1903.76C1157.92,-1872.04 1157.92,-1813.61 1157.92,-1813.61 1157.92,-1813.61 1157.92,-1813.61 1157.92,-1448.14 1157.92,-1448.14 1128.15,-1409.15 1102.29,-1375.3"/>
<polygon fill="#888888" stroke="#888888" stroke-width="1.2" points="1104.48,-1374.13 1098.29,-1370.05 1100.59,-1377.1 1104.48,-1374.13"/>
<text xml:space="preserve" text-anchor="middle" x="1167.67" y="-1605.01" font-family="Inter" font-size="9.00"> skip</text>
</g>
<!-- NYSTROM -->
<g id="node9" class="node">
<title>NYSTROM</title>
<path fill="#9fa8da" stroke="#3949ab" stroke-width="1.4" d="M1047.52,-1724.79C1047.52,-1724.79 884.32,-1724.79 884.32,-1724.79 878.32,-1724.79 872.32,-1718.79 872.32,-1712.79 872.32,-1712.79 872.32,-1665.39 872.32,-1665.39 872.32,-1659.39 878.32,-1653.39 884.32,-1653.39 884.32,-1653.39 1047.52,-1653.39 1047.52,-1653.39 1053.52,-1653.39 1059.52,-1659.39 1059.52,-1665.39 1059.52,-1665.39 1059.52,-1712.79 1059.52,-1712.79 1059.52,-1718.79 1053.52,-1724.79 1047.52,-1724.79"/>
<text xml:space="preserve" text-anchor="middle" x="965.92" y="-1707.14" font-family="Inter" font-size="11.00">Nystr√∂m Approx.</text>
<text xml:space="preserve" text-anchor="middle" x="965.92" y="-1692.89" font-family="Inter" font-size="11.00"> m‚â™n landmarks</text>
<text xml:space="preserve" text-anchor="middle" x="965.92" y="-1678.64" font-family="Inter" font-size="11.00">√Ç = Q&#39;(K&#39;)‚Å∫K·µÄ</text>
<text xml:space="preserve" text-anchor="middle" x="965.92" y="-1664.39" font-family="Inter" font-size="11.00">O(n log n)</text>
</g>
<!-- QKV&#45;&gt;NYSTROM -->
<g id="edge10" class="edge">
<title>QKV&#45;&gt;NYSTROM</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M998.22,-1783.41C987.25,-1771.37 976.92,-1760.04 976.92,-1760.04 976.92,-1760.04 975.03,-1748.01 972.81,-1733.93"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="975.27,-1733.8 971.77,-1727.27 970.43,-1734.56 975.27,-1733.8"/>
</g>
<!-- MHA_FALLBACK -->
<g id="node11" class="node">
<title>MHA_FALLBACK</title>
<path fill="#e8eaf6" stroke="#9fa8da" stroke-width="1.4" stroke-dasharray="5,2" d="M1089.88,-1629.39C1089.88,-1629.39 997.96,-1629.39 997.96,-1629.39 991.96,-1629.39 985.96,-1623.39 985.96,-1617.39 985.96,-1617.39 985.96,-1598.49 985.96,-1598.49 985.96,-1592.49 991.96,-1586.49 997.96,-1586.49 997.96,-1586.49 1089.88,-1586.49 1089.88,-1586.49 1095.88,-1586.49 1101.88,-1592.49 1101.88,-1598.49 1101.88,-1598.49 1101.88,-1617.39 1101.88,-1617.39 1101.88,-1623.39 1095.88,-1629.39 1089.88,-1629.39"/>
<text xml:space="preserve" text-anchor="middle" x="1043.92" y="-1611.74" font-family="Inter" font-size="11.00">Standard MHA</text>
<text xml:space="preserve" text-anchor="middle" x="1043.92" y="-1597.49" font-family="Inter" font-size="11.00">(fallback n‚â§1024)</text>
</g>
<!-- QKV&#45;&gt;MHA_FALLBACK -->
<g id="edge11" class="edge">
<title>QKV&#45;&gt;MHA_FALLBACK</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1023.92,-1783.51C1023.92,-1766.78 1023.92,-1748.79 1023.92,-1748.79 1023.92,-1748.79 1079.92,-1724.79 1079.92,-1724.79 1079.92,-1724.79 1079.92,-1653.39 1079.92,-1653.39 1079.92,-1653.39 1073.63,-1645.62 1066.31,-1636.58"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1068.32,-1635.17 1062.01,-1631.27 1064.51,-1638.25 1068.32,-1635.17"/>
<text xml:space="preserve" text-anchor="middle" x="1062.92" y="-1751.49" font-family="Inter" font-size="9.00"> short&#45;ctx fallback</text>
</g>
<!-- SCHULZ -->
<g id="node10" class="node">
<title>SCHULZ</title>
<path fill="#c5cae9" stroke="#5c6bc0" stroke-width="1.4" d="M1014.38,-1562.49C1014.38,-1562.49 907.46,-1562.49 907.46,-1562.49 901.46,-1562.49 895.46,-1556.49 895.46,-1550.49 895.46,-1550.49 895.46,-1531.59 895.46,-1531.59 895.46,-1525.59 901.46,-1519.59 907.46,-1519.59 907.46,-1519.59 1014.38,-1519.59 1014.38,-1519.59 1020.38,-1519.59 1026.38,-1525.59 1026.38,-1531.59 1026.38,-1531.59 1026.38,-1550.49 1026.38,-1550.49 1026.38,-1556.49 1020.38,-1562.49 1014.38,-1562.49"/>
<text xml:space="preserve" text-anchor="middle" x="960.92" y="-1544.84" font-family="Inter" font-size="11.00">Schulz Iterations</text>
<text xml:space="preserve" text-anchor="middle" x="960.92" y="-1530.59" font-family="Inter" font-size="11.00">(Moore&#45;Penrose K‚Å∫)</text>
</g>
<!-- NYSTROM&#45;&gt;SCHULZ -->
<g id="edge12" class="edge">
<title>NYSTROM&#45;&gt;SCHULZ</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M964.71,-1652.73C963.86,-1627.99 962.74,-1595.3 961.94,-1571.87"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="964.39,-1571.8 961.7,-1564.88 959.49,-1571.96 964.39,-1571.8"/>
</g>
<!-- ATTN_OUT -->
<g id="node12" class="node">
<title>ATTN_OUT</title>
<path fill="#c5cae9" stroke="#5c6bc0" stroke-width="1.4" d="M1090.26,-1470.59C1090.26,-1470.59 1039.59,-1470.59 1039.59,-1470.59 1033.59,-1470.59 1027.59,-1464.59 1027.59,-1458.59 1027.59,-1458.59 1027.59,-1439.69 1027.59,-1439.69 1027.59,-1433.69 1033.59,-1427.69 1039.59,-1427.69 1039.59,-1427.69 1090.26,-1427.69 1090.26,-1427.69 1096.26,-1427.69 1102.26,-1433.69 1102.26,-1439.69 1102.26,-1439.69 1102.26,-1458.59 1102.26,-1458.59 1102.26,-1464.59 1096.26,-1470.59 1090.26,-1470.59"/>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-1452.94" font-family="Inter" font-size="11.00">Attention</text>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-1438.69" font-family="Inter" font-size="11.00">Output</text>
</g>
<!-- SCHULZ&#45;&gt;ATTN_OUT -->
<g id="edge13" class="edge">
<title>SCHULZ&#45;&gt;ATTN_OUT</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M985.3,-1518.96C999.91,-1506.34 1018.61,-1490.17 1034.21,-1476.68"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1035.62,-1478.7 1039.32,-1472.27 1032.42,-1474.99 1035.62,-1478.7"/>
</g>
<!-- MHA_FALLBACK&#45;&gt;ATTN_OUT -->
<g id="edge14" class="edge">
<title>MHA_FALLBACK&#45;&gt;ATTN_OUT</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M1046.75,-1585.79C1050.41,-1558.48 1056.8,-1510.78 1060.94,-1479.84"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1063.36,-1480.26 1061.86,-1473 1058.5,-1479.61 1063.36,-1480.26"/>
</g>
<!-- ATTN_OUT&#45;&gt;RESID1 -->
<g id="edge15" class="edge">
<title>ATTN_OUT&#45;&gt;RESID1</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1064.92,-1427.2C1064.92,-1416.22 1064.92,-1402.13 1064.92,-1387.99"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1067.37,-1388.03 1064.92,-1381.03 1062.47,-1388.03 1067.37,-1388.03"/>
</g>
<!-- RMSNORM2 -->
<g id="node14" class="node">
<title>RMSNORM2</title>
<ellipse fill="#c5cae9" stroke="#3949ab" stroke-width="1.4" cx="1049.92" cy="-1202.77" rx="55.45" ry="20.26"/>
<text xml:space="preserve" text-anchor="middle" x="1049.92" y="-1199.44" font-family="Inter" font-size="11.00">RMSNorm</text>
</g>
<!-- RESID1&#45;&gt;RMSNORM2 -->
<g id="edge17" class="edge">
<title>RESID1&#45;&gt;RMSNORM2</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1058.38,-1271.82C1056.69,-1258.16 1054.92,-1243.97 1053.44,-1232.1"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1055.9,-1231.97 1052.6,-1225.32 1051.03,-1232.57 1055.9,-1231.97"/>
</g>
<!-- OT_COST -->
<g id="node15" class="node">
<title>OT_COST</title>
<path fill="#ffcdd2" stroke="#c62828" stroke-width="1.4" d="M1128.92,-1119.26C1128.92,-1119.26 936.92,-1119.26 936.92,-1119.26 930.92,-1119.26 924.92,-1113.26 924.92,-1107.26 924.92,-1107.26 924.92,-1088.36 924.92,-1088.36 924.92,-1082.36 930.92,-1076.36 936.92,-1076.36 936.92,-1076.36 1128.92,-1076.36 1128.92,-1076.36 1134.92,-1076.36 1140.92,-1082.36 1140.92,-1088.36 1140.92,-1088.36 1140.92,-1107.26 1140.92,-1107.26 1140.92,-1113.26 1134.92,-1119.26 1128.92,-1119.26"/>
<text xml:space="preserve" text-anchor="middle" x="1032.92" y="-1101.61" font-family="Inter" font-size="11.00">Transport Cost</text>
<text xml:space="preserve" text-anchor="middle" x="1032.92" y="-1087.36" font-family="Inter" font-size="11.00"> c_ij = ‚àí‚ü®h·µ¢,e‚±º‚ü©/œÑ + Œª¬∑load(j)</text>
</g>
<!-- RMSNORM2&#45;&gt;OT_COST -->
<g id="edge18" class="edge">
<title>RMSNORM2&#45;&gt;OT_COST</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1046.64,-1181.92C1044.13,-1166.69 1040.62,-1145.44 1037.78,-1128.23"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1040.22,-1127.96 1036.66,-1121.45 1035.38,-1128.76 1040.22,-1127.96"/>
</g>
<!-- RESID2 -->
<g id="node20" class="node">
<title>RESID2</title>
<ellipse fill="#ffffff" stroke="#3949ab" stroke-width="1.4" cx="1064.92" cy="-616.68" rx="53.33" ry="53.33"/>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-618.98" font-family="Inter" font-size="11.00">Ôºã</text>
<text xml:space="preserve" text-anchor="middle" x="1064.92" y="-607.73" font-family="Inter" font-size="11.00">(residual)</text>
</g>
<!-- RMSNORM2&#45;&gt;RESID2 -->
<g id="edge24" class="edge">
<title>RMSNORM2&#45;&gt;RESID2</title>
<path fill="none" stroke="#888888" stroke-width="1.2" stroke-dasharray="1,5" d="M1083.52,-1186.09C1116.51,-1170.7 1161.92,-1149.51 1161.92,-1149.51 1161.92,-1149.51 1161.92,-711.01 1161.92,-711.01 1161.92,-711.01 1134.88,-684.99 1109.35,-660.43"/>
<polygon fill="#888888" stroke="#888888" stroke-width="1.2" points="1111.31,-658.91 1104.57,-655.83 1107.91,-662.44 1111.31,-658.91"/>
<text xml:space="preserve" text-anchor="middle" x="1171.67" y="-937.66" font-family="Inter" font-size="9.00"> skip</text>
</g>
<!-- SINKHORN -->
<g id="node16" class="node">
<title>SINKHORN</title>
<path fill="#ef9a9a" stroke="#c62828" stroke-width="1.4" d="M1129.12,-1027.36C1129.12,-1027.36 922.72,-1027.36 922.72,-1027.36 916.72,-1027.36 910.72,-1021.36 910.72,-1015.36 910.72,-1015.36 910.72,-982.21 910.72,-982.21 910.72,-976.21 916.72,-970.21 922.72,-970.21 922.72,-970.21 1129.12,-970.21 1129.12,-970.21 1135.12,-970.21 1141.12,-976.21 1141.12,-982.21 1141.12,-982.21 1141.12,-1015.36 1141.12,-1015.36 1141.12,-1021.36 1135.12,-1027.36 1129.12,-1027.36"/>
<text xml:space="preserve" text-anchor="middle" x="1025.92" y="-1009.71" font-family="Inter" font-size="11.00">Sinkhorn Iterations</text>
<text xml:space="preserve" text-anchor="middle" x="1025.92" y="-995.46" font-family="Inter" font-size="11.00"> œÄ* = argmin Œ£c_ijœÄ_ij + ŒµH(œÄ)</text>
<text xml:space="preserve" text-anchor="middle" x="1025.92" y="-981.21" font-family="Inter" font-size="11.00">(doubly stochastic plan)</text>
</g>
<!-- OT_COST&#45;&gt;SINKHORN -->
<g id="edge19" class="edge">
<title>OT_COST&#45;&gt;SINKHORN</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1031.4,-1075.76C1030.57,-1064.24 1029.52,-1049.63 1028.56,-1036.32"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1031.02,-1036.41 1028.07,-1029.61 1026.13,-1036.77 1031.02,-1036.41"/>
</g>
<!-- EXPERTS -->
<g id="node17" class="node">
<title>EXPERTS</title>
<path fill="#ffcdd2" stroke="#c62828" stroke-width="1.4" d="M1132.38,-910.96C1132.38,-910.96 899.46,-910.96 899.46,-910.96 893.46,-910.96 887.46,-904.96 887.46,-898.96 887.46,-898.96 887.46,-865.81 887.46,-865.81 887.46,-859.81 893.46,-853.81 899.46,-853.81 899.46,-853.81 1132.38,-853.81 1132.38,-853.81 1138.38,-853.81 1144.38,-859.81 1144.38,-865.81 1144.38,-865.81 1144.38,-898.96 1144.38,-898.96 1144.38,-904.96 1138.38,-910.96 1132.38,-910.96"/>
<text xml:space="preserve" text-anchor="middle" x="1015.92" y="-893.31" font-family="Inter" font-size="11.00">Expert FFNs</text>
<text xml:space="preserve" text-anchor="middle" x="1015.92" y="-879.06" font-family="Inter" font-size="11.00">(SwiGLU √ó E)</text>
<text xml:space="preserve" text-anchor="middle" x="1015.92" y="-864.81" font-family="Inter" font-size="11.00"> FFN(x)=W_down(SiLU(W_gate¬∑x)‚äôW_up¬∑x)</text>
</g>
<!-- SINKHORN&#45;&gt;EXPERTS -->
<g id="edge20" class="edge">
<title>SINKHORN&#45;&gt;EXPERTS</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1023.47,-969.8C1022.17,-954.84 1020.54,-936.24 1019.13,-920.13"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1021.58,-920.05 1018.53,-913.29 1016.7,-920.47 1021.58,-920.05"/>
</g>
<!-- AUX_LOSS -->
<g id="node18" class="node">
<title>AUX_LOSS</title>
<polygon fill="#ffcdd2" stroke="#c62828" stroke-width="1.4" stroke-dasharray="5,2" points="903.92,-804.81 765.5,-761.91 903.92,-719.01 1042.34,-761.91 903.92,-804.81"/>
<text xml:space="preserve" text-anchor="middle" x="903.92" y="-765.71" font-family="Inter" font-size="11.00">Aux Balance Loss</text>
<text xml:space="preserve" text-anchor="middle" x="903.92" y="-751.46" font-family="Inter" font-size="11.00"> ‚Ñí_aux = Œ±E Œ£f_j¬∑P_j</text>
</g>
<!-- EXPERTS&#45;&gt;AUX_LOSS -->
<g id="edge22" class="edge">
<title>EXPERTS&#45;&gt;AUX_LOSS</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M989.38,-853.31C973.08,-836.06 952.12,-813.9 935.04,-795.83"/>
</g>
<!-- MOE_OUT -->
<g id="node19" class="node">
<title>MOE_OUT</title>
<path fill="#ffcdd2" stroke="#c62828" stroke-width="1.4" d="M1131.88,-783.36C1131.88,-783.36 1093.96,-783.36 1093.96,-783.36 1087.96,-783.36 1081.96,-777.36 1081.96,-771.36 1081.96,-771.36 1081.96,-752.46 1081.96,-752.46 1081.96,-746.46 1087.96,-740.46 1093.96,-740.46 1093.96,-740.46 1131.88,-740.46 1131.88,-740.46 1137.88,-740.46 1143.88,-746.46 1143.88,-752.46 1143.88,-752.46 1143.88,-771.36 1143.88,-771.36 1143.88,-777.36 1137.88,-783.36 1131.88,-783.36"/>
<text xml:space="preserve" text-anchor="middle" x="1112.92" y="-765.71" font-family="Inter" font-size="11.00">MoE</text>
<text xml:space="preserve" text-anchor="middle" x="1112.92" y="-751.46" font-family="Inter" font-size="11.00">Output</text>
</g>
<!-- EXPERTS&#45;&gt;MOE_OUT -->
<g id="edge21" class="edge">
<title>EXPERTS&#45;&gt;MOE_OUT</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1032.51,-853.25C1039.88,-840.75 1046.92,-828.81 1046.92,-828.81 1046.92,-828.81 1067.73,-808.03 1085.98,-789.81"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1087.53,-791.72 1090.75,-785.04 1084.07,-788.26 1087.53,-791.72"/>
</g>
<!-- LOSS_TOTAL -->
<g id="node31" class="node">
<title>LOSS_TOTAL</title>
<path fill="#fff9c4" stroke="#f57f17" stroke-width="1.8" d="M146.34,-82.65C146.34,-82.65 11.58,-46.05 11.58,-46.05 5.79,-44.47 5.79,-41.33 11.58,-39.75 11.58,-39.75 146.34,-3.15 146.34,-3.15 152.13,-1.57 163.71,-1.57 169.5,-3.15 169.5,-3.15 304.26,-39.75 304.26,-39.75 310.05,-41.33 310.05,-44.47 304.26,-46.05 304.26,-46.05 169.5,-82.65 169.5,-82.65 163.71,-84.23 152.13,-84.23 146.34,-82.65"/>
<text xml:space="preserve" text-anchor="middle" x="157.92" y="-46.7" font-family="Inter" font-size="11.00">Total Loss</text>
<text xml:space="preserve" text-anchor="middle" x="157.92" y="-32.45" font-family="Inter" font-size="11.00"> ‚Ñí = ‚Ñí_LM + Œ±¬∑‚Ñí_aux</text>
</g>
<!-- AUX_LOSS&#45;&gt;LOSS_TOTAL -->
<g id="edge32" class="edge">
<title>AUX_LOSS&#45;&gt;LOSS_TOTAL</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M817.95,-745.1C615.36,-707.85 124.92,-617.68 124.92,-617.68 124.92,-617.68 124.92,-617.68 124.92,-173.45 124.92,-173.45 136.27,-128.89 145.66,-92.03"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="147.95,-92.97 147.3,-85.59 143.2,-91.76 147.95,-92.97"/>
<text xml:space="preserve" text-anchor="middle" x="143.67" y="-377.07" font-family="Inter" font-size="9.00"> ‚Ñí_aux</text>
</g>
<!-- MOE_OUT&#45;&gt;RESID2 -->
<g id="edge23" class="edge">
<title>MOE_OUT&#45;&gt;RESID2</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1105.84,-739.78C1100.19,-722.93 1092.01,-698.52 1084.44,-675.93"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="1086.81,-675.3 1082.27,-669.44 1082.17,-676.85 1086.81,-675.3"/>
</g>
<!-- SDE_GATE -->
<g id="node21" class="node">
<title>SDE_GATE</title>
<path fill="#a5d6a7" stroke="#2e7d32" stroke-width="1.4" d="M964.72,-500.1C964.72,-500.1 787.12,-500.1 787.12,-500.1 781.12,-500.1 775.12,-494.1 775.12,-488.1 775.12,-488.1 775.12,-469.2 775.12,-469.2 775.12,-463.2 781.12,-457.2 787.12,-457.2 787.12,-457.2 964.72,-457.2 964.72,-457.2 970.72,-457.2 976.72,-463.2 976.72,-469.2 976.72,-469.2 976.72,-488.1 976.72,-488.1 976.72,-494.1 970.72,-500.1 964.72,-500.1"/>
<text xml:space="preserve" text-anchor="middle" x="875.92" y="-482.45" font-family="Inter" font-size="11.00">DropPath Gate</text>
<text xml:space="preserve" text-anchor="middle" x="875.92" y="-468.2" font-family="Inter" font-size="11.00"> p_‚Ñì = 1 ‚àí (‚Ñì/L)¬∑(1‚àíp_min)</text>
</g>
<!-- RESID2&#45;&gt;SDE_GATE -->
<g id="edge25" class="edge">
<title>RESID2&#45;&gt;SDE_GATE</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M1021.56,-584.47C988.43,-560.63 943.29,-528.14 912.09,-505.69"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="913.85,-503.93 906.74,-501.83 910.99,-507.91 913.85,-503.93"/>
</g>
<!-- HW1 -->
<g id="node26" class="node">
<title>HW1</title>
<polygon fill="#f0f4c3" stroke="#558b2f" stroke-width="1.4" points="647.76,-195.9 510.09,-195.9 510.09,-153 653.76,-153 653.76,-189.9 647.76,-195.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="647.76,-195.9 647.76,-189.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="653.76,-189.9 647.76,-189.9"/>
<text xml:space="preserve" text-anchor="middle" x="581.92" y="-178.25" font-family="Inter" font-size="11.00">BF16 AMP</text>
<text xml:space="preserve" text-anchor="middle" x="581.92" y="-164" font-family="Inter" font-size="11.00">(auto mixed precision)</text>
</g>
<!-- RESID2&#45;&gt;HW1 -->
<!-- HW2 -->
<g id="node27" class="node">
<title>HW2</title>
<polygon fill="#f0f4c3" stroke="#558b2f" stroke-width="1.4" points="1199.88,-195.9 1053.96,-195.9 1053.96,-153 1205.88,-153 1205.88,-189.9 1199.88,-195.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1199.88,-195.9 1199.88,-189.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1205.88,-189.9 1199.88,-189.9"/>
<text xml:space="preserve" text-anchor="middle" x="1129.92" y="-178.25" font-family="Inter" font-size="11.00">Gradient Checkpointing</text>
<text xml:space="preserve" text-anchor="middle" x="1129.92" y="-164" font-family="Inter" font-size="11.00">O(‚àöL d) memory</text>
</g>
<!-- RESID2&#45;&gt;HW2 -->
<!-- HW3 -->
<g id="node28" class="node">
<title>HW3</title>
<polygon fill="#f0f4c3" stroke="#558b2f" stroke-width="1.4" points="1007.88,-195.9 885.96,-195.9 885.96,-153 1013.88,-153 1013.88,-189.9 1007.88,-195.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1007.88,-195.9 1007.88,-189.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" points="1013.88,-189.9 1007.88,-189.9"/>
<text xml:space="preserve" text-anchor="middle" x="949.92" y="-178.25" font-family="Inter" font-size="11.00">Grad Accumulation</text>
<text xml:space="preserve" text-anchor="middle" x="949.92" y="-164" font-family="Inter" font-size="11.00">(virtual large batch)</text>
</g>
<!-- RESID2&#45;&gt;HW3 -->
<!-- SDE_GATE&#45;&gt;RMSNORM1 -->
<g id="edge27" class="edge">
<title>SDE_GATE&#45;&gt;RMSNORM1</title>
<path fill="none" stroke="#3949ab" stroke-width="1.2" stroke-dasharray="5,2" d="M942.03,-500.77C1019.65,-525.57 1137.92,-563.35 1137.92,-563.35 1137.92,-563.35 1172.92,-711.01 1172.92,-711.01 1172.92,-711.01 1191.92,-934.96 1191.92,-934.96 1191.92,-934.96 1191.92,-946.21 1191.92,-946.21 1191.92,-946.21 1187.92,-1629.39 1187.92,-1629.39 1187.92,-1629.39 1168.92,-1880.44 1168.92,-1880.44 1168.92,-1880.44 1167.2,-1887.2 1165.12,-1895.38"/>
<polygon fill="#3949ab" stroke="#3949ab" stroke-width="1.2" points="1162.77,-1894.69 1163.42,-1902.08 1167.52,-1895.9 1162.77,-1894.69"/>
<text xml:space="preserve" text-anchor="middle" x="1211.91" y="-1199.84" font-family="Inter" font-size="9.00" fill="#3949ab"> repeat √óL</text>
</g>
<!-- SDE_NOISE -->
<g id="node22" class="node">
<title>SDE_NOISE</title>
<polygon fill="#c8e6c9" stroke="#2e7d32" stroke-width="1.4" stroke-dasharray="5,2" points="943.63,-408.2 808.21,-408.2 808.21,-351.05 943.63,-351.05 943.63,-408.2"/>
<text xml:space="preserve" text-anchor="middle" x="875.92" y="-390.55" font-family="Inter" font-size="11.00">Diffusion Term</text>
<text xml:space="preserve" text-anchor="middle" x="875.92" y="-376.3" font-family="Inter" font-size="11.00"> g_œÜ(h,t)¬∑‚àöŒît¬∑Œæ</text>
<text xml:space="preserve" text-anchor="middle" x="875.92" y="-362.05" font-family="Inter" font-size="11.00">(zeroed at inference)</text>
</g>
<!-- SDE_GATE&#45;&gt;SDE_NOISE -->
<g id="edge26" class="edge">
<title>SDE_GATE&#45;&gt;SDE_NOISE</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M875.92,-456.6C875.92,-445.08 875.92,-430.47 875.92,-417.16"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="878.37,-417.45 875.92,-410.45 873.47,-417.45 878.37,-417.45"/>
</g>
<!-- RMSNORM_F -->
<g id="node23" class="node">
<title>RMSNORM_F</title>
<ellipse fill="#b2dfdb" stroke="#00695c" stroke-width="1.4" cx="662.92" cy="-379.62" rx="78.79" ry="20.26"/>
<text xml:space="preserve" text-anchor="middle" x="662.92" y="-376.3" font-family="Inter" font-size="11.00">RMSNorm (final)</text>
</g>
<!-- SDE_GATE&#45;&gt;RMSNORM_F -->
<g id="edge28" class="edge">
<title>SDE_GATE&#45;&gt;RMSNORM_F</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M829.7,-456.6C793.87,-440.28 744.46,-417.77 708.74,-401.49"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="709.91,-399.34 702.53,-398.67 707.88,-403.8 709.91,-399.34"/>
</g>
<!-- LM_HEAD -->
<g id="node24" class="node">
<title>LM_HEAD</title>
<path fill="#80cbc4" stroke="#00695c" stroke-width="2" d="M708.88,-302.05C708.88,-302.05 616.96,-302.05 616.96,-302.05 610.96,-302.05 604.96,-296.05 604.96,-290.05 604.96,-290.05 604.96,-271.15 604.96,-271.15 604.96,-265.15 610.96,-259.15 616.96,-259.15 616.96,-259.15 708.88,-259.15 708.88,-259.15 714.88,-259.15 720.88,-265.15 720.88,-271.15 720.88,-271.15 720.88,-290.05 720.88,-290.05 720.88,-296.05 714.88,-302.05 708.88,-302.05"/>
<text xml:space="preserve" text-anchor="middle" x="662.92" y="-284.4" font-family="Inter" font-size="11.00">LM Head</text>
<text xml:space="preserve" text-anchor="middle" x="662.92" y="-270.15" font-family="Inter" font-size="11.00">(Linear ‚Üí Vocab)</text>
</g>
<!-- RMSNORM_F&#45;&gt;LM_HEAD -->
<g id="edge29" class="edge">
<title>RMSNORM_F&#45;&gt;LM_HEAD</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M662.92,-358.99C662.92,-345.38 662.92,-327.01 662.92,-311.58"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="665.37,-311.71 662.92,-304.71 660.47,-311.71 665.37,-311.71"/>
</g>
<!-- OUTPUT -->
<g id="node25" class="node">
<title>OUTPUT</title>
<path fill="#e0f2f1" stroke="#00695c" stroke-width="1.4" d="M457.87,-203.1C457.87,-203.1 256.06,-203.1 256.06,-203.1 250.06,-203.1 239.79,-198.89 235.51,-194.67 235.51,-194.67 194.51,-154.23 194.51,-154.23 190.24,-150.01 191.97,-145.8 197.97,-145.8 197.97,-145.8 399.78,-145.8 399.78,-145.8 405.78,-145.8 416.05,-150.01 420.33,-154.23 420.33,-154.23 461.33,-194.67 461.33,-194.67 465.6,-198.89 463.87,-203.1 457.87,-203.1"/>
<text xml:space="preserve" text-anchor="middle" x="327.92" y="-171.13" font-family="Inter" font-size="11.00">Logits &#160;≈∑ ‚àà ‚Ñù^{|V|}</text>
</g>
<!-- LM_HEAD&#45;&gt;OUTPUT -->
<g id="edge30" class="edge">
<title>LM_HEAD&#45;&gt;OUTPUT</title>
<path fill="none" stroke="black" stroke-width="1.2" d="M604.18,-261.34C555.36,-246.16 484.81,-224.23 427.22,-206.32"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="427.97,-203.99 420.56,-204.25 426.52,-208.67 427.97,-203.99"/>
</g>
<!-- HW5 -->
<g id="node30" class="node">
<title>HW5</title>
<polygon fill="#dcedc8" stroke="#558b2f" stroke-width="1.4" stroke-dasharray="5,2" points="840.26,-195.9 693.59,-195.9 693.59,-153 846.26,-153 846.26,-189.9 840.26,-195.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" stroke-dasharray="5,2" points="840.26,-195.9 840.26,-189.9"/>
<polyline fill="none" stroke="#558b2f" stroke-width="1.4" stroke-dasharray="5,2" points="846.26,-189.9 840.26,-189.9"/>
<text xml:space="preserve" text-anchor="middle" x="769.92" y="-178.25" font-family="Inter" font-size="11.00">KV&#45;Cache Compression</text>
<text xml:space="preserve" text-anchor="middle" x="769.92" y="-164" font-family="Inter" font-size="11.00">(Phase 1+)</text>
</g>
<!-- LM_HEAD&#45;&gt;HW5 -->
<!-- OUTPUT&#45;&gt;LOSS_TOTAL -->
<g id="edge31" class="edge">
<title>OUTPUT&#45;&gt;LOSS_TOTAL</title>
<path fill="none" stroke="black" stroke-width="1.2" stroke-dasharray="5,2" d="M291.03,-145.34C266.1,-126.34 232.92,-101.06 205.93,-80.49"/>
<polygon fill="black" stroke="black" stroke-width="1.2" points="207.71,-78.76 200.65,-76.47 204.74,-82.66 207.71,-78.76"/>
<text xml:space="preserve" text-anchor="middle" x="276.15" y="-113.25" font-family="Inter" font-size="9.00"> ‚Ñí_LM</text>
</g>
</g>
</svg>
